---

decay: 0.0005

sub_models:
- name: backbone
  layers_config:
  - type: convolutional
    batch_normalize: 1
    filters: 32
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 64
    size: 3
    stride: 2
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 32
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 64
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 3
    stride: 2
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 64
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 64
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 3
    stride: 2
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear


  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 3
    stride: 2
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear


  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear


  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear


  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear


  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear


  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 1024
    size: 3
    stride: 2
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 1024
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 1024
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 1024
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 1024
    size: 3
    stride: 1
    pad: 1
    activation: leaky

  - type: shortcut
    from: -3
    activation: linear

- name: neck0
  layers_config:

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    size: 3
    stride: 1
    pad: 1
    filters: 1024
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    size: 3
    stride: 1
    pad: 1
    filters: 1024
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 512
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    size: 3
    stride: 1
    pad: 1
    filters: 1024
    activation: leaky

- name: head0
  layers_config:

  - type: convolutional
    size: 1
    stride: 1
    pad: 1
    filters:  3*(2+2+1+nclasses) # ngrids*(xy_field+wh_field+obj_field+nclasses)
    activation: linear
  - type: yolo
    jitter: .3


- name: neck1
  layers_config:

  - type: route
    layers :
    - -4

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: upsample
    stride: 2

  - type: route
    layers :
    - -1
    - 61

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    size: 3
    stride: 1
    pad: 1
    filters: 512
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    size: 3
    stride: 1
    pad: 1
    filters: 512
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 256
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    size: 3
    stride: 1
    pad: 1
    filters: 512
    activation: leaky

- name: head1
  layers_config:
  - type: convolutional
    size: 1
    stride: 1
    pad: 1
    filters: 3*(2+2+1+nclasses) # ngrids*(xy_field+wh_field+obj_field+nclasses)
    activation: linear

  - type: yolo
    jitter: .3

- name: neck2
  layers_config:

  - type: route
    layers :
    - -4

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: upsample
    stride: 2

  - type: route
    layers :
    - -1
    -  36



  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    size: 3
    stride: 1
    pad: 1
    filters: 256
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 1
    stride: 1
    pad: 1
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    size: 3
    stride: 1
    pad: 1
    filters: 256
    activation: leaky

  - type: convolutional
    batch_normalize: 1
    filters: 128
    size: 1
    stride: 1
    pad: 1
    activation: leaky


  - type: convolutional
    batch_normalize: 1
    size: 3
    stride: 1
    pad: 1
    filters: 256
    activation: leaky

- name: head2
  layers_config:
  - type: convolutional
    size: 1
    stride: 1
    pad: 1
    filters:  3*(2+2+1+nclasses) # ngrids*(xy_field+wh_field+obj_field+nclasses)
    activation: linear

  - type: yolo
    jitter: .3



